\documentclass[11pt]{article}
\usepackage{amsmath, amssymb, geometry}
\geometry{margin=1in}
\setlength{\parskip}{1em}
\setlength{\parindent}{0pt}

\begin{document}

\begin{center}
{\Large \textbf{README: SDOF Response Spectrum Using the Newmark--$\beta$ Method}}\\[4pt]
\text{Subakaran Rajenthirakumar}\\
\texttt{newmark\_beta\_response\_spectrum.m}
\end{center}

\textbf{Purpose.}  
This MATLAB script computes displacement ($S_d$), velocity ($S_v$), and acceleration ($S_a$) response spectra of a single-degree-of-freedom (SDOF) system subjected to an input force or ground acceleration record. The dynamic response of each oscillator (corresponding to a selected period $T$) is obtained using the general \textbf{Newmark--$\beta$ time integration method}.

The user provides mass, damping ratio, and a range of natural periods. The script automatically computes the corresponding stiffness, performs Newmark integration for each oscillator, and extracts peak displacement, velocity, and acceleration.

\vspace{0.5cm}

\textbf{Governing Equation of Motion}


For a linear SDOF system under external force $p(t)$:
\[
m\,\ddot{v}(t) + c\,\dot{v}(t) + k\,v(t) = p(t),
\]
where
\[
m = \text{mass},\quad
c = 2 \zeta \sqrt{km} = \text{damping},\quad
k = \text{stiffness},\quad
v(t) = \text{relative displacement}.
\]

If the input is ground acceleration $a_g(t)$ instead of force:
\[
p(t) = -m\,a_g(t).
\]

The script handles both cases.

\vspace{0.5cm}

\textbf{Newmark--$\beta$ Method: General Formulation}


The Newmark method approximates displacement and velocity over each time step using:
\[
v_{t+\Delta t} = v_t + \Delta t\,\dot{v}_t + \Delta t^2\left[\left(\tfrac{1}{2}-\beta\right)\ddot{v}_t + \beta\,\ddot{v}_{t+\Delta t}\right],
\]
\[
\dot{v}_{t+\Delta t} = \dot{v}_t + \Delta t\left[(1-\gamma)\ddot{v}_t + \gamma\,\ddot{v}_{t+\Delta t}\right],
\]
where:
\[
\beta,\ \gamma \in \mathbb{R}
\]
are numerical parameters controlling stability and numerical damping.

Common choices:
\[
(\beta=\tfrac{1}{4},\;\gamma=\tfrac{1}{2}) 
\quad\Rightarrow\quad \text{Average Acceleration Method (unconditionally stable)},
\]
\[
(\beta=\tfrac{1}{6},\;\gamma=\tfrac{1}{2})
\quad\Rightarrow\quad \text{Linear Acceleration Method}.
\]

Adjust the values as necessary, but the script uses the following values
\[
\beta = \tfrac{1}{4}, \qquad \gamma = \tfrac{1}{2}.
\]

\vspace{0.5cm}

\textbf{Effective Stiffness and Effective Force}


Rearranging the Newmark equations yields:
\[
\ddot{v}_{t+\Delta t} =
a_0(v_{t+\Delta t}-v_t)
- a_2 \dot{v}_t 
- a_3 \ddot{v}_t,
\]
where:
\[
a_0 = \frac{1}{\beta\Delta t^2},\quad
a_1 = \frac{\gamma}{\beta\Delta t},\quad
a_2 = \frac{1}{\beta\Delta t},\quad
a_3 = \frac{1}{2\beta}-1,
\]
\[
a_4 = \frac{\gamma}{\beta}-1,\quad
a_5 = \Delta t\left(\frac{\gamma}{2\beta}-1\right).
\]

Substituting $\ddot{v}_{t+\Delta t}$ into the SDOF equation gives:
\[
k_\text{eff} v_{t+\Delta t} = p_\text{eff},
\]
with:
\[
k_{\text{eff}} = k + a_1 c + a_0 m,
\]
\[
p_{\text{eff}} =
p_{t+\Delta t}
+ m\left(a_0 v_t + a_2 \dot{v}_t + a_3 \ddot{v}_t\right)
+ c\left(a_1 v_t + a_4 \dot{v}_t + a_5 \ddot{v}_t\right).
\]

Then:
\[
v_{t+\Delta t} = \frac{p_{\text{eff}}}{k_{\text{eff}}},
\]
and $\dot{v}_{t+\Delta t}, \ddot{v}_{t+\Delta t}$ follow from Newmark update equations.

\vspace{0.5cm}

\textbf{Construction of the Response Spectrum}


The user specifies an array of natural periods:
\[
T \in \{T_1, T_2, \dots, T_n\}.
\]

For each $T$:
\[
\omega = \frac{2\pi}{T},\qquad k = m\omega^2,\qquad c=2\zeta\sqrt{km}.
\]

A time-history is computed using Newmark integration.  
Peak absolute values are recorded:

\[
S_d(T) = \max_t |v(t)|,
\]
\[
S_v(T) = \max_t |\dot{v}(t)|,
\]
\[
S_a(T) = \max_t |\ddot{v}(t)|.
\]

These are plotted in three subplots:
\[
T \;\text{vs.}\; S_d, \qquad
T \;\text{vs.}\; S_v, \qquad
T \;\text{vs.}\; S_a.
\]

\vspace{0.5cm}

\textbf{Load Types and Unit Conversions}


The script accepts:
\begin{itemize}
    \item forces in N, kN, or kip,
    \item ground accelerations in $m/s^2$ or $g$.
\end{itemize}

For ground acceleration:
\[
p(t) = \pm m\,a_g(t).
\]

For weight inputs:
\[
W = mg \quad\Rightarrow\quad m = \frac{W}{g}.
\]

Unit conversions:
\[
1\,\text{kN} = 1000\,\text{N},\qquad
1\,\text{kip} = 4448.22\,\text{N},\qquad
1\,g = 9.80665\,\text{m/s}^2.
\]

\vspace{0.6cm}

\textbf{Numerical Stability Considerations}


For general Newmark parameters:
\[
\beta \ge \frac{1}{4}\left(\gamma + \frac{1}{2}\right)^2
\quad\Rightarrow\quad \text{Unconditional stability}.
\]

Thus:
\[
(\beta=\tfrac{1}{4},\;\gamma=\tfrac{1}{2})
\]
is always stable regardless of time step $\Delta t$.

Nevertheless, accuracy still requires:
\[
\Delta t \ll T.
\]

Typical engineering choice:
\[
\Delta t \le \frac{T}{50}.
\]

\vspace{0.6cm}

\textbf{Summary of Algorithm Used in the Script}

For each period $T$:

\begin{enumerate}
\item Compute $k = m\omega^2$, $c = 2\zeta\sqrt{km}$.
\item Initialize $v(0)=0$, $\dot{v}(0)=0$, compute $\ddot{v}(0)$.
\item Precompute Newmark constants $a_0,\dots,a_5$.
\item Form effective stiffness $k_\text{eff}$.
\item For each time step:
    \begin{itemize}
        \item compute $p_\text{eff}$,
        \item solve for $v_{t+\Delta t}$,
        \item update $\dot{v}$ and $\ddot{v}$,
        \item record maximum absolute response.
    \end{itemize}
\item Store $S_d(T)$, $S_v(T)$, $S_a(T)$.
\end{enumerate}

After looping through all periods, plot the three response spectra.

\vspace{0.5cm}

\hrule
\vspace{0.3cm}

This document explains the theory, numerical formulation, and implementation details of the Newmark--$\beta$ method used in \texttt{newmark\_beta\_response\_spectrum.m} and provides a complete mathematical foundation for interpreting the computed response spectra.

\end{document}
